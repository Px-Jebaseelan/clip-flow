[{"filePath":"E:\\Px Projectz\\Assignment-Project\\screen-recorder\\eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Px Projectz\\Assignment-Project\\screen-recorder\\next.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Px Projectz\\Assignment-Project\\screen-recorder\\postcss.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Px Projectz\\Assignment-Project\\screen-recorder\\src\\actions\\trim.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'uuidv4' is defined but never used.","line":7,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":22,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"uuidv4"},"fix":{"range":[140,176],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use server\";\r\n\r\nimport ffmpeg from \"fluent-ffmpeg\";\r\nimport path from \"path\";\r\nimport fs from \"fs\";\r\nimport { addVideo } from \"@/lib/db\";\r\nimport { v4 as uuidv4 } from \"uuid\";\r\n\r\n// We need uuid logic again. Since I can't import straightforwardly from storage if I didn't export it or it's not a library.\r\n// I'll just use crypto.randomUUID().\r\n\r\nexport async function trimVideo(relativePath: string, start: number, end: number): Promise<{ id: string; url: string }> {\r\n    const cleanPath = relativePath.startsWith(\"/\") ? relativePath.slice(1) : relativePath;\r\n    const inputPath = path.join(process.cwd(), \"public\", cleanPath);\r\n\r\n    if (!fs.existsSync(inputPath)) {\r\n        throw new Error(\"Input file not found: \" + inputPath);\r\n    }\r\n\r\n    const id = crypto.randomUUID();\r\n    const ext = path.extname(inputPath);\r\n    const outputFilename = `${id}${ext}`; // Use ID as filename for consistency\r\n    const outputRelativePath = `uploads/${outputFilename}`;\r\n    const outputPath = path.join(process.cwd(), \"public\", \"uploads\", outputFilename);\r\n\r\n    // Ensure uploads dir exists (redundant but safe)\r\n    if (!fs.existsSync(path.dirname(outputPath))) {\r\n        fs.mkdirSync(path.dirname(outputPath), { recursive: true });\r\n    }\r\n\r\n    return new Promise((resolve, reject) => {\r\n        ffmpeg(inputPath)\r\n            .setStartTime(start)\r\n            .setDuration(end - start)\r\n            .output(outputPath)\r\n            .on(\"end\", () => {\r\n                const url = \"/\" + outputRelativePath;\r\n                addVideo({\r\n                    id,\r\n                    filename: outputFilename,\r\n                    originalName: \"trimmed-\" + path.basename(inputPath),\r\n                    path: url,\r\n                    createdAt: new Date().toISOString(),\r\n                    views: 0\r\n                });\r\n                resolve({ id, url });\r\n            })\r\n            .on(\"error\", (err) => {\r\n                console.error(\"Trim error:\", err);\r\n                reject(err);\r\n            })\r\n            .run();\r\n    });\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\Px Projectz\\Assignment-Project\\screen-recorder\\src\\actions\\upload.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Px Projectz\\Assignment-Project\\screen-recorder\\src\\app\\edit\\[id]\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Px Projectz\\Assignment-Project\\screen-recorder\\src\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Px Projectz\\Assignment-Project\\screen-recorder\\src\\app\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Px Projectz\\Assignment-Project\\screen-recorder\\src\\app\\record\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Px Projectz\\Assignment-Project\\screen-recorder\\src\\app\\view\\[id]\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Px Projectz\\Assignment-Project\\screen-recorder\\src\\components\\editor\\VideoEditor.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Share2' is defined but never used.","line":6,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":45,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Share2"},"fix":{"range":[209,217],"text":""},"desc":"Remove unused variable \"Share2\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport React, { useState, useRef, useEffect } from \"react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { trimVideo } from \"@/actions/trim\";\r\nimport { Loader2, Scissors, Download, Share2, Copy } from \"lucide-react\";\r\n\r\ninterface VideoEditorProps {\r\n    videoUrl: string;\r\n    onTrimComplete?: (newUrl: string) => void;\r\n}\r\n\r\nexport function VideoEditor({ videoUrl, onTrimComplete }: VideoEditorProps) {\r\n    const videoRef = useRef<HTMLVideoElement>(null);\r\n    const [duration, setDuration] = useState(0);\r\n    const [startTime, setStartTime] = useState(0);\r\n    const [endTime, setEndTime] = useState(0);\r\n    const [isProcessing, setIsProcessing] = useState(false);\r\n    const [trimmedUrl, setTrimmedUrl] = useState<string | null>(null);\r\n    const [trimmedId, setTrimmedId] = useState<string | null>(null);\r\n\r\n    useEffect(() => {\r\n        setTrimmedUrl(null);\r\n        setTrimmedId(null);\r\n        setStartTime(0);\r\n    }, [videoUrl]);\r\n\r\n    const handleLoadedMetadata = () => {\r\n        if (videoRef.current) {\r\n            const vidDuration = videoRef.current.duration;\r\n            setDuration(vidDuration);\r\n            setEndTime(vidDuration);\r\n        }\r\n    };\r\n\r\n    const handleTrim = async () => {\r\n        if (startTime >= endTime) {\r\n            alert(\"Start time must be before end time\");\r\n            return;\r\n        }\r\n\r\n        setIsProcessing(true);\r\n        try {\r\n            const result = await trimVideo(videoUrl, startTime, endTime);\r\n            setTrimmedUrl(result.url);\r\n            setTrimmedId(result.id);\r\n            if (onTrimComplete) onTrimComplete(result.url);\r\n        } catch (error) {\r\n            console.error(\"Trim failed:\", error);\r\n            alert(\"Failed to trim video.\");\r\n        } finally {\r\n            setIsProcessing(false);\r\n        }\r\n    };\r\n\r\n    const copyShareLink = () => {\r\n        if (trimmedId) {\r\n            const url = `${window.location.origin}/view/${trimmedId}`;\r\n            navigator.clipboard.writeText(url);\r\n            alert(\"Link copied to clipboard!\");\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            <div className=\"aspect-video bg-black rounded-lg overflow-hidden border border-gray-200 shadow-sm relative\">\r\n                <video\r\n                    key={trimmedUrl || videoUrl}\r\n                    ref={videoRef}\r\n                    src={trimmedUrl || videoUrl}\r\n                    controls\r\n                    className=\"w-full h-full\"\r\n                    onLoadedMetadata={handleLoadedMetadata}\r\n                />\r\n                {isProcessing && (\r\n                    <div className=\"absolute inset-0 bg-black/50 flex items-center justify-center text-white backdrop-blur-sm\">\r\n                        <div className=\"flex flex-col items-center gap-2\">\r\n                            <Loader2 className=\"w-8 h-8 animate-spin\" />\r\n                            <p>Processing...</p>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {!trimmedUrl && (\r\n                <div className=\"p-4 bg-slate-50 rounded-lg border border-slate-100 space-y-4\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                        <h3 className=\"font-medium text-slate-900\">Trim Video</h3>\r\n                        <span className=\"text-sm text-slate-500\">Duration: {duration.toFixed(1)}s</span>\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                        <div className=\"space-y-1\">\r\n                            <label className=\"text-xs font-medium text-gray-500\">Start Time (s)</label>\r\n                            <input\r\n                                type=\"number\"\r\n                                min={0}\r\n                                max={endTime}\r\n                                step={0.1}\r\n                                value={startTime}\r\n                                onChange={(e) => setStartTime(Number(e.target.value))}\r\n                                className=\"w-full px-3 py-2 border rounded-md text-sm\"\r\n                            />\r\n                        </div>\r\n                        <div className=\"space-y-1\">\r\n                            <label className=\"text-xs font-medium text-gray-500\">End Time (s)</label>\r\n                            <input\r\n                                type=\"number\"\r\n                                min={startTime}\r\n                                max={duration}\r\n                                step={0.1}\r\n                                value={endTime}\r\n                                onChange={(e) => setEndTime(Number(e.target.value))}\r\n                                className=\"w-full px-3 py-2 border rounded-md text-sm\"\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex justify-end pt-2\">\r\n                        <Button onClick={handleTrim} disabled={isProcessing}>\r\n                            <Scissors className=\"w-4 h-4 mr-2\" />\r\n                            Trim Selection\r\n                        </Button>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {trimmedUrl && (\r\n                <div className=\"flex items-center justify-between p-4 bg-green-50 rounded-lg border border-green-100 text-green-800\">\r\n                    <div className=\"font-medium\">Trim Complete!</div>\r\n                    <div className=\"flex gap-2\">\r\n                        <a\r\n                            href={trimmedUrl}\r\n                            download\r\n                            className=\"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-green-600 text-white hover:bg-green-700 h-9 px-4 py-2\"\r\n                        >\r\n                            <Download className=\"w-4 h-4 mr-2\" />\r\n                            Download\r\n                        </a>\r\n                        <Button\r\n                            variant=\"outline\"\r\n                            className=\"border-green-200 bg-white hover:bg-green-100 text-green-900\"\r\n                            onClick={copyShareLink}\r\n                        >\r\n                            <Copy className=\"w-4 h-4 mr-2\" />\r\n                            Copy Link\r\n                        </Button>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\Px Projectz\\Assignment-Project\\screen-recorder\\src\\components\\recorder\\Recorder.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Button' is defined but never used.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":16,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Button"},"fix":{"range":[122,170],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Loader2' is defined but never used.","line":6,"column":51,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":58,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Loader2"},"fix":{"range":[220,229],"text":""},"desc":"Remove unused variable \"Loader2\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport React, { useEffect } from \"react\";\r\nimport { useMediaRecorder } from \"@/hooks/useMediaRecorder\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Mic, MicOff, Video, Square, AlertCircle, Loader2 } from \"lucide-react\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\n// Make sure to implement Button component or use standard HTML for now if UI lib mock not ready.\r\n// Since I haven't created \"@/components/ui/button\", I will create a basic version inline or just use HTML buttons with classes.\r\n// I'll stick to HTML + Tailwind for speed unless I create a Button component. \r\n// I'll create a simple reusable Button component in this file or just usage.\r\n\r\ninterface RecorderProps {\r\n    onRecordingComplete: (blob: Blob) => void;\r\n}\r\n\r\nexport function Recorder({ onRecordingComplete }: RecorderProps) {\r\n    const {\r\n        status,\r\n        startRecording,\r\n        stopRecording,\r\n        mediaBlob,\r\n        isAudioEnabled,\r\n        setIsAudioEnabled,\r\n        error,\r\n        clearRecording\r\n    } = useMediaRecorder();\r\n\r\n    useEffect(() => {\r\n        if (mediaBlob && status === \"stopped\") {\r\n            onRecordingComplete(mediaBlob);\r\n            // We don't clear automatically, parent handles it\r\n        }\r\n    }, [mediaBlob, status, onRecordingComplete]);\r\n\r\n    if (error) {\r\n        return (\r\n            <div className=\"flex flex-col items-center gap-4 p-8 border border-red-200 bg-red-50 rounded-lg text-red-600\">\r\n                <AlertCircle className=\"w-8 h-8\" />\r\n                <p>{error}</p>\r\n                <button\r\n                    onClick={clearRecording}\r\n                    className=\"px-4 py-2 bg-red-100 hover:bg-red-200 rounded-md font-medium transition-colors\"\r\n                >\r\n                    Try Again\r\n                </button>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"flex flex-col items-center justify-center gap-8 p-12 py-24 border-2 border-dashed border-gray-200 rounded-xl bg-gray-50/50\">\r\n            <div className=\"flex flex-col items-center gap-2\">\r\n                <h2 className=\"text-2xl font-bold tracking-tight text-gray-900\">\r\n                    {status === \"recording\" ? \"Recording in progress...\" : \"Start Recording\"}\r\n                </h2>\r\n                <p className=\"text-gray-500\">\r\n                    {status === \"recording\"\r\n                        ? \"Click stop when you're done.\"\r\n                        : \"Record your screen and microphone.\"}\r\n                </p>\r\n            </div>\r\n\r\n            <div className=\"flex items-center gap-6\">\r\n                {/* Mic Toggle */}\r\n                <button\r\n                    onClick={() => setIsAudioEnabled(!isAudioEnabled)}\r\n                    disabled={status === \"recording\"}\r\n                    className={cn(\r\n                        \"p-4 rounded-full transition-all duration-200\",\r\n                        isAudioEnabled\r\n                            ? \"bg-blue-100 text-blue-600 hover:bg-blue-200\"\r\n                            : \"bg-gray-100 text-gray-400 hover:bg-gray-200\",\r\n                        status === \"recording\" && \"opacity-50 cursor-not-allowed\"\r\n                    )}\r\n                    title={isAudioEnabled ? \"Microphone On\" : \"Microphone Off\"}\r\n                >\r\n                    {isAudioEnabled ? <Mic className=\"w-6 h-6\" /> : <MicOff className=\"w-6 h-6\" />}\r\n                </button>\r\n\r\n                {/* Record Control */}\r\n                {status === \"idle\" || status === \"stopped\" ? (\r\n                    <button\r\n                        onClick={startRecording}\r\n                        className=\"group relative flex items-center justify-center p-6 bg-red-600 hover:bg-red-700 text-white rounded-full shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300\"\r\n                    >\r\n                        <Video className=\"w-8 h-8 fill-current\" />\r\n                        <span className=\"absolute -bottom-8 text-sm font-medium text-gray-500 whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity\">\r\n                            Start\r\n                        </span>\r\n                    </button>\r\n                ) : (\r\n                    <button\r\n                        onClick={stopRecording}\r\n                        className=\"group relative flex items-center justify-center p-6 bg-slate-800 hover:bg-slate-900 text-white rounded-full shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300 animate-pulse\"\r\n                    >\r\n                        <Square className=\"w-8 h-8 fill-current\" />\r\n                        <span className=\"absolute -bottom-8 text-sm font-medium text-gray-500 whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity\">\r\n                            Stop\r\n                        </span>\r\n                    </button>\r\n                )}\r\n            </div>\r\n\r\n            {status === \"recording\" && (\r\n                <div className=\"flex items-center gap-2 text-sm text-red-600 font-medium animate-pulse\">\r\n                    <div className=\"w-2 h-2 bg-red-600 rounded-full\" />\r\n                    Recording\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\Px Projectz\\Assignment-Project\\screen-recorder\\src\\components\\ui\\button.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Slot' is defined but never used.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":14,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Slot"},"fix":{"range":[32,75],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'asChild' is assigned a value but never used.","line":44,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":44,"endColumn":41}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\r\nimport { Slot } from \"@radix-ui/react-slot\"\r\nimport { type VariantProps, cva } from \"class-variance-authority\"\r\nimport { cn } from \"@/lib/utils\"\r\n\r\n// Since I am not installing radix-ui/react-slot, I will implement a simpler version without Slot for now or just generic button.\r\n// Actually, standard shadcn/ui button uses radix-ui. I'll make a simple one without Slot for MVP to avoid extra installs, \r\n// OR I will just use a standard HTML button in my usages if I didn't want to install extra deps.\r\n// But I imported Slot. I'll rewrite to not use Slot to save installs.\r\n\r\nconst buttonVariants = cva(\r\n    \"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\",\r\n    {\r\n        variants: {\r\n            variant: {\r\n                default: \"bg-slate-900 text-slate-50 hover:bg-slate-900/90\",\r\n                destructive: \"bg-red-500 text-slate-50 hover:bg-red-500/90\",\r\n                outline: \"border border-slate-200 bg-white hover:bg-slate-100 hover:text-slate-900\",\r\n                secondary: \"bg-slate-100 text-slate-900 hover:bg-slate-100/80\",\r\n                ghost: \"hover:bg-slate-100 hover:text-slate-900\",\r\n                link: \"text-slate-900 underline-offset-4 hover:underline\",\r\n            },\r\n            size: {\r\n                default: \"h-10 px-4 py-2\",\r\n                sm: \"h-9 rounded-md px-3\",\r\n                lg: \"h-11 rounded-md px-8\",\r\n                icon: \"h-10 w-10\",\r\n            },\r\n        },\r\n        defaultVariants: {\r\n            variant: \"default\",\r\n            size: \"default\",\r\n        },\r\n    }\r\n)\r\n\r\nexport interface ButtonProps\r\n    extends React.ButtonHTMLAttributes<HTMLButtonElement>,\r\n    VariantProps<typeof buttonVariants> {\r\n    asChild?: boolean\r\n}\r\n\r\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\r\n    ({ className, variant, size, asChild = false, ...props }, ref) => {\r\n        // const Comp = asChild ? Slot : \"button\"\r\n        const Comp = \"button\" // simplification\r\n        return (\r\n            <Comp\r\n                className={cn(buttonVariants({ variant, size, className }))}\r\n                ref={ref}\r\n                {...props}\r\n            />\r\n        )\r\n    }\r\n)\r\nButton.displayName = \"Button\"\r\n\r\nexport { Button, buttonVariants }\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\Px Projectz\\Assignment-Project\\screen-recorder\\src\\hooks\\useMediaRecorder.ts","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`stopRecording` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nE:\\Px Projectz\\Assignment-Project\\screen-recorder\\src\\hooks\\useMediaRecorder.ts:97:17\n   95 |             // Handle stream end (user stops sharing via browser UI)\n   96 |             displayStream.getVideoTracks()[0].onended = () => {\n>  97 |                 stopRecording();\n      |                 ^^^^^^^^^^^^^ `stopRecording` accessed before it is declared\n   98 |             };\n   99 |\n  100 |         } catch (err: any) {\n\nE:\\Px Projectz\\Assignment-Project\\screen-recorder\\src\\hooks\\useMediaRecorder.ts:106:5\n  104 |     }, [isAudioEnabled]);\n  105 |\n> 106 |     const stopRecording = useCallback(() => {\n      |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 107 |         if (mediaRecorderRef.current && mediaRecorderRef.current.state !== \"inactive\") {\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 108 |             mediaRecorderRef.current.stop();\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 109 |             setStatus(\"stopped\");\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 110 |         }\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 111 |     }, []);\n      | ^^^^^^^^^^^^ `stopRecording` is declared here\n  112 |\n  113 |     const clearRecording = useCallback(() => {\n  114 |         setMediaBlob(null);","line":97,"column":17,"nodeType":null,"endLine":97,"endColumn":30},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":100,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":100,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3644,3647],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3644,3647],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'stopRecording'. Either include it or remove the dependency array.","line":104,"column":8,"nodeType":"ArrayExpression","endLine":104,"endColumn":24,"suggestions":[{"desc":"Update the dependencies array to be: [isAudioEnabled, stopRecording]","fix":{"range":[3769,3785],"text":"[isAudioEnabled, stopRecording]"}}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useRef, useCallback } from \"react\";\r\n\r\nexport type RecordingStatus = \"idle\" | \"recording\" | \"stopped\";\r\n\r\ninterface UseMediaRecorderReturn {\r\n    status: RecordingStatus;\r\n    isAudioEnabled: boolean;\r\n    setIsAudioEnabled: (enabled: boolean) => void;\r\n    startRecording: () => Promise<void>;\r\n    stopRecording: () => void;\r\n    mediaBlob: Blob | null;\r\n    clearRecording: () => void;\r\n    error: string | null;\r\n}\r\n\r\nexport function useMediaRecorder(): UseMediaRecorderReturn {\r\n    const [status, setStatus] = useState<RecordingStatus>(\"idle\");\r\n    const [isAudioEnabled, setIsAudioEnabled] = useState(true);\r\n    const [mediaBlob, setMediaBlob] = useState<Blob | null>(null);\r\n    const [error, setError] = useState<string | null>(null);\r\n\r\n    const mediaRecorderRef = useRef<MediaRecorder | null>(null);\r\n    const chunksRef = useRef<Blob[]>([]);\r\n    const streamRef = useRef<MediaStream | null>(null);\r\n\r\n    const startRecording = useCallback(async () => {\r\n        try {\r\n            setError(null);\r\n\r\n            // 1. Get Screen Stream (Video + System Audio)\r\n            const displayStream = await navigator.mediaDevices.getDisplayMedia({\r\n                video: true,\r\n                audio: true\r\n            });\r\n\r\n            // 2. Get Mic Stream (if enabled)\r\n            let combinedStream = displayStream;\r\n            let micStream: MediaStream | null = null;\r\n\r\n            if (isAudioEnabled) {\r\n                try {\r\n                    micStream = await navigator.mediaDevices.getUserMedia({\r\n                        audio: {\r\n                            echoCancellation: true,\r\n                            noiseSuppression: true,\r\n                        }\r\n                    });\r\n\r\n                    // Combine tracks\r\n                    // Note: multiple audio tracks might behave differently across browsers/players. \r\n                    // For MVP, simplistic track addition.\r\n                    const tracks = [\r\n                        ...displayStream.getTracks(),\r\n                        ...micStream.getAudioTracks()\r\n                    ];\r\n\r\n                    combinedStream = new MediaStream(tracks);\r\n                } catch (err) {\r\n                    console.warn(\"Microphone access denied or error:\", err);\r\n                    // Proceed with just screen\r\n                }\r\n            }\r\n\r\n            streamRef.current = combinedStream;\r\n\r\n            // 3. Setup Recorder\r\n            // Try to use webm\r\n            const options = { mimeType: \"video/webm; codecs=vp9\" };\r\n            const recorder = new MediaRecorder(combinedStream,\r\n                MediaRecorder.isTypeSupported(options.mimeType) ? options : undefined\r\n            );\r\n\r\n            recorder.ondataavailable = (event) => {\r\n                if (event.data.size > 0) {\r\n                    chunksRef.current.push(event.data);\r\n                }\r\n            };\r\n\r\n            recorder.onstop = () => {\r\n                const blob = new Blob(chunksRef.current, { type: \"video/webm\" });\r\n                setMediaBlob(blob);\r\n                chunksRef.current = [];\r\n\r\n                // Stop all tracks\r\n                streamRef.current?.getTracks().forEach(track => track.stop());\r\n                streamRef.current = null;\r\n            };\r\n\r\n            mediaRecorderRef.current = recorder;\r\n            recorder.start();\r\n            setStatus(\"recording\");\r\n\r\n            // Handle stream end (user stops sharing via browser UI)\r\n            displayStream.getVideoTracks()[0].onended = () => {\r\n                stopRecording();\r\n            };\r\n\r\n        } catch (err: any) {\r\n            setError(err.message || \"Failed to start recording\");\r\n            setStatus(\"idle\");\r\n        }\r\n    }, [isAudioEnabled]);\r\n\r\n    const stopRecording = useCallback(() => {\r\n        if (mediaRecorderRef.current && mediaRecorderRef.current.state !== \"inactive\") {\r\n            mediaRecorderRef.current.stop();\r\n            setStatus(\"stopped\");\r\n        }\r\n    }, []);\r\n\r\n    const clearRecording = useCallback(() => {\r\n        setMediaBlob(null);\r\n        setStatus(\"idle\");\r\n        setError(null);\r\n    }, []);\r\n\r\n    return {\r\n        status,\r\n        isAudioEnabled,\r\n        setIsAudioEnabled,\r\n        startRecording,\r\n        stopRecording,\r\n        mediaBlob,\r\n        clearRecording,\r\n        error\r\n    };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\Px Projectz\\Assignment-Project\\screen-recorder\\src\\lib\\db.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":22,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import fs from \"fs\";\r\nimport path from \"path\";\r\n\r\nconst DB_PATH = path.join(process.cwd(), \"db.json\");\r\n\r\nexport interface VideoData {\r\n    id: string;\r\n    filename: string;\r\n    originalName: string;\r\n    path: string; // url path\r\n    createdAt: string;\r\n    views: number;\r\n}\r\n\r\nfunction readDb(): VideoData[] {\r\n    if (!fs.existsSync(DB_PATH)) {\r\n        return [];\r\n    }\r\n    const data = fs.readFileSync(DB_PATH, \"utf-8\");\r\n    try {\r\n        return JSON.parse(data);\r\n    } catch (e) {\r\n        return [];\r\n    }\r\n}\r\n\r\nfunction writeDb(data: VideoData[]) {\r\n    fs.writeFileSync(DB_PATH, JSON.stringify(data, null, 2));\r\n}\r\n\r\nexport function addVideo(video: VideoData) {\r\n    const db = readDb();\r\n    db.push(video);\r\n    writeDb(db);\r\n}\r\n\r\nexport function getVideo(id: string): VideoData | undefined {\r\n    const db = readDb();\r\n    return db.find((v) => v.id === id);\r\n}\r\n\r\nexport function incrementViews(id: string) {\r\n    const db = readDb();\r\n    const video = db.find((v) => v.id === id);\r\n    if (video) {\r\n        video.views = (video.views || 0) + 1;\r\n        writeDb(db);\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\Px Projectz\\Assignment-Project\\screen-recorder\\src\\lib\\storage.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'uuidv4' is defined but never used.","line":3,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":22,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"uuidv4"},"fix":{"range":[48,84],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import fs from \"fs\";\r\nimport path from \"path\";\r\nimport { v4 as uuidv4 } from \"uuid\";\r\n\r\n// We need to polyfill uuid or just use a simple random string generator if uuid not installed.\r\n// I didn't install uuid. I'll use crypto.randomUUID or a simple helper.\r\n// Node 19+ has global crypto.randomUUID. Next.js 14 runs on newer Node.\r\n\r\nexport async function saveFile(file: Blob, folder: string = \"uploads\"): Promise<{ id: string; url: string; filepath: string; filename: string }> {\r\n    const buffer = Buffer.from(await file.arrayBuffer());\r\n    const id = crypto.randomUUID();\r\n    const ext = file.type.split(\"/\")[1] || \"webm\";\r\n    const filename = `${id}.${ext}`;\r\n    const uploadDir = path.join(process.cwd(), \"public\", folder);\r\n\r\n    if (!fs.existsSync(uploadDir)) {\r\n        fs.mkdirSync(uploadDir, { recursive: true });\r\n    }\r\n\r\n    const filepath = path.join(uploadDir, filename);\r\n    fs.writeFileSync(filepath, buffer);\r\n\r\n    return {\r\n        id,\r\n        url: `/${folder}/${filename}`,\r\n        filepath,\r\n        filename\r\n    };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\Px Projectz\\Assignment-Project\\screen-recorder\\src\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]